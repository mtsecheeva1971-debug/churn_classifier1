# Классификатор оттока клиентов (Churn Classifier)

Нейросетевая модель для предсказания оттока клиентов на основе их характеристик.

## Описание

Проект использует искусственную нейронную сеть (Keras/TensorFlow) для предсказания вероятности оттока клиентов. Модель анализирует следующие признаки:
- **Стаж клиента** (tenure) - количество месяцев использования услуги
- **Ежемесячная плата** (monthly_charges) - размер ежемесячного платежа
- **Количество услуг** (num_services) - число подключенных услуг
- **Обращения в поддержку** (support_calls) - количество обращений в службу поддержки

Модель предсказывает вероятность оттока клиента (0 = останется, 1 = уйдет).

## Технологии

- Python 3.x
- Pandas
- NumPy
- Scikit-learn
- TensorFlow/Keras
- Matplotlib (для визуализации)

## Установка

1. Клонируйте репозиторий:

```bash
git clone <https://github.com/mtsecheeva1971-debug/churn_classifier1>
```

2. Перейдите в директорию проекта:

```bash
cd churn_classifier
```

3. Создайте и активируйте виртуальное окружение:

```bash
python -m venv venv
source venv/bin/activate  # Для Windows: venv\Scripts\activate
```

4. Установите зависимости:

```bash
pip install pandas numpy scikit-learn tensorflow matplotlib
```

## Использование

Откройте Jupyter Notebook:

```bash
jupyter notebook churn_classifier.ipynb
```

Или используйте JupyterLab:

```bash
jupyter lab churn_classifier.ipynb
```

Notebook выполнит следующие действия:
1. Сгенерирует искусственный датасет из 2000 клиентов
2. Разделит данные на обучающую и тестовую выборки
3. Обучит нейронную сеть
4. Сохранит модель (`churn_model.h5`) и scaler (`churn_scaler.pkl`)
5. Покажет примеры предсказаний для конкретных клиентов
6. Визуализирует результаты и проанализирует факторы оттока

## Структура модели

Нейронная сеть состоит из:
- Входной слой (4 признака)
- Скрытый слой: 16 нейронов с активацией ReLU
- Скрытый слой: 8 нейронов с активацией ReLU
- Выходной слой: 1 нейрон с активацией sigmoid (вероятность оттока)

## Примеры работы модели

В ноутбуке представлены примеры работы модели на конкретных клиентах:

- **Клиент с высоким риском оттока**: новый клиент, высокая цена, много обращений в поддержку
- **Клиент с низким риском оттока**: долгосрочный клиент, низкая цена, мало обращений

Модель показывает:
- Вероятность оттока для каждого клиента
- Визуализацию результатов
- Анализ факторов, влияющих на отток

## Результаты

После обучения модель выводит:
- Точность на тестовой выборке
- Предсказания для примеров клиентов с вероятностями
- Визуализацию результатов (графики)
- Анализ факторов оттока

## Сохраненные файлы

После выполнения ноутбука создаются:
- `churn_model.h5` - обученная модель
- `churn_scaler.pkl` - нормализатор данных

## Пример использования сохраненной модели

```python
from tensorflow.keras.models import load_model
import pickle
import numpy as np

model = load_model('churn_model.h5')
with open('churn_scaler.pkl', 'rb') as f:
    scaler = pickle.load(f)

new_customer = np.array([[12, 75.0, 3, 6]])
new_customer_scaled = scaler.transform(new_customer)
prediction = model.predict(new_customer_scaled, verbose=0)
churn_probability = prediction[0][0]

print(f'Вероятность оттока: {churn_probability:.1%}')
if churn_probability > 0.5:
    print('Рекомендация: Клиент находится в зоне риска оттока!')
else:
    print('Клиент с низким риском оттока.')
```

## Факторы оттока

Модель выявила следующие закономерности:
- **Короткий стаж** + **высокая цена** = высокий риск оттока
- **Много обращений в поддержку** увеличивает вероятность оттока
- **Долгосрочные клиенты** с низкими ценами реже уходят
- **Больше услуг** может снижать риск оттока

## Лицензия

MIT
